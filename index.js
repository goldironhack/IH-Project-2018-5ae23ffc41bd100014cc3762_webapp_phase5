var HashNeigh = [212,210,212,208,208,208,208,212,207,212,212,211,210,207,205,205,205,206,206,204,201,201,201,202,202,203,209,209,210,210,209,210,211,211,206,208,208,210,210,210,209,212,211,204,209,212,310,311,307,301,315,313,315,314,314,308,317,312,307,308,316,301,304,303,302,306,306,306,306,302,306,305,305,305,318,318,-1,315,313,311,312,310,315,318,302,313,302,302,309,316,305,318,314,314,318,305,301,301,301,302,312,310,103,112,112,109,109,110,111,108,108,108,108,107,107,104,105,106,104,102,103,103,101,102,102,102,107,109,106,101,101,401,402,403,404,410,404,406,409,409,407,402,402,403,405,405,405,406,409,410,410,407,407,411,411,411,411,413,413,408,408,408,412,411,413,412,412,412,412,413,413,413,414,414,414,401,407,407,414,414,414,414,407,413,408,408,407,408,401,410,413,404,414,414,414,413,413,403,406,501,501,501,501,501,501,502,502,501,501,501,501,502,502,502,503,503,503,503,503,503,501,501,501,314,309,317,501,501,501,501,502,502,502,502,502,502,502,503,503,503,503,503,503,503,503,502,502,502,502,108,103,101,105,503,501,501,502,502,501,501,501,317,305,318,318,408,408,408,401,203,203,204,205,106,402,106,106,106,105,402,402,-1,302,308,305,302,502,502,503,502,414,315,405,503,502,503,407,305,315];


var HashCrime = [307,410,412,412,414,502,201,314,410,302,314,204,307,317,111,209,204,204,412,401,207,313,501,206,211,106,502,406,206,305,204,301,110,407,315,202,309,209,307,204,302,201,306,211,204,503,301,303,112,301,412,107,502,309,104,303,501,211,208,111,201,103,310,201,403,407,307,204,205,304,103,314,502,209,210,413,403,308,207,108,110,207,109,313,301,203,317,318,303,307,212,407,405,310,105,402,307,317,203,318,206,317,212,208,414,212,306,401,501,301,308,104,318,412,315,401,204,111,409,309,301,316,404,317,205,203,316,305,307,109,314,108,410,212,207,105,164,317,104,309,317,208,305,211,411,111,201,103,303,204,102,305,211,401,204,102,414,305,209,207,206,303,107,111,413,211,406,203,205,410,112,204,303,502,404,305,202,206,105,404,409,101,403,109,403,207,212,308,105,410,401,206,208,208,403,413,501,203,108,404,305,501,102,302,501,112,412,315,103,410,401,318,315,205,107,410,401,313,412,502,313,308,314,311,101,404,310,108,304,355,303,203,410,107,203,206,109,407,206,109,407,410,412,211,501,403,401,112,414,308,104,308,303,105,407,318,111,210,403,102,105,107,210,204,304,411,318,209,112,409,407,202,412,201,314,402,301,105,308,310,318,413,409,104,412,306,105,111,109,301,318,305,110,309,102,107,406,112,209,206,402,305,108,304,112,210,301,501,112,316,305,307,209,205,310,205,309,210,111,209,209,309,309,503,413,105,209,401,309,316,307,317,317,313,104,404,317,207,304,413,206,205,105,303,411,501,414,409,405,301,303,111,412,105,105,209,410,109,112,112,208,304,202,317,205,202,305,403,205,211,313,112,402,305,306,414,105,405,110,311,104,404,312,103,308,401,317,108,102,412,105,303,103,409,207,108,201,501,107,101,212,406,501,309,206,310,204,305,307,205,211,107,302,501,201,501,208,303,410,111,301,207,308,401,314,310,413,314,412,501,401,102,302,307,201,302,112,502,107,316,502,203,403,309,316,304,318,211,112,301,317,412,205,412,102,309,105,309,303,318,205,202,401,413,210,312,502,409,301,110,317,112,311,204,311,316,212,305,412,412,305,316,317,308,305,401,305,316,205,203,110,316,306,204,305,203,501,403,210,401,207,106,318,101,108,413,212,401,502,409,302,207,409,306,317,412,211,102,412,410,412,318,313,105,209,305,309,202,305,206,317,206,318,211,314,206,204,312,305,401,301,409,103,105,210,205,102,307,317,411,312,112,111,201,406,410,201,305,201,412,310,210,207,317,106,402,103,202,314,501,307,503,206,103,318,502,205,210,111,108,101,201,104,302,108,206,412,317,211,206,304,316,204,104,303,307,316,206,307,207,105,208,408,110,408,201,305,112,211,105,502,310,414,410,111,105,408,408,403,103,105,405,204,210,108,305,203,201,208,313,103,108,401,318,103,403,307,318,111,409,102,401,313,307,104,305,318,305,212,207,201,412,303,301,317,314,401,201,312,202,403,414,310,204,208,309,212,406,209,318,306,209,206,305,501,212,314,204,164,204,309,309,302,205,312,105,102,207,313,112,305,409,203,208,201,303,401,207,206,205,403,208,312,112,315,305,305,103,403,402,401,309,112,308,318,211,204,401,207,406,203,401,401,201,205,206,502,204,207,210,110,105,412,412,204,204,311,107,107,205,406,501,313,305,205,410,318,105,409,111,105,212,105,305,410,104,409,311,210,410,303,408,206,305,501,318,318,403,303,409,305,412,101,305,108,406,307,203,204,413,207,209,413,310,409,306,407,312,401,102,402,316,306,407,305,108,316,404,401,412,502,501,303,410,103,209,318,204,102,203,412,501,318,201,411,208,302,405,202,501,202,317,308,303,306,403,413,303,412,401,406,206,110,301,204,401,403,306,107,205,303,401,107,107,302,105,201,203,303,111,412,318,201,210,204,301,204,412,309,411,209,317,306,503,313,405,211,318,312,112,104,414,210,109,209,308,407,203,111,309,105,112,102,316,308,501,308,106,408,205,209,303,102,501,304,205,406,314,503,306,104,403,405,109,208,107,313,307,205,407,307,105,406,404,205,309,306,312,204,303,202,501,410,405,301,109,207,317,407,315,412,205,102,413,101,401,212,107,404,201,111,317,303,312,502,109,412,314,209,312,307,401,309,209,401,202,306,105,208,104,315,112,103,205,414,501,203,208,301,318,402,108,310,412,105,204,205,201,501,410,414,409,111,105,303,414,303];


var HashAfford = [2,31,0,2,2,0,0,17,3,14,8,0,0,66,0,11,0,19,10,17,0,0,0,26,24,0,3,1,0,23,18,0,0,0,1,0,9,5,6,19,6,0,0,0,0,0,1,2,6,19,0,40,1,0,5,0,4,0,4,7,4,44,0,2,0,0,31,0,1,0,5];

var map;

function initMap() {
  map = new google.maps.Map(document.getElementById('mapContainer'), {
      center: {lat: 40.7291, lng: -73.9965},
      zoom: 16
  });
  
   map.data.loadGeoJson(
    'https://services5.arcgis.com/GfwWNkhOj9bNBqoJ/arcgis/rest/services/nycd/FeatureServer/0/query?where=1=1&outFields=*&outSR=4326&f=geojson');

    hideDistricts();
}

function getColorByBoroCD ( id ){
    
    var valBoro =  Math.floor(id/100);
    
    if( valBoro == 1 ) return "#2F4B95"; //blue
    if( valBoro == 2 ) return "#FBE925"; //yellow
    if( valBoro == 3 ) return "#F63F43"; //red
    if( valBoro == 4 ) return "#FD9938"; //orange
    if( valBoro == 5 ) return "#9FCF21"; //green
}


var BoroName = ["Manhattan", "Bronx", "Brooklyn", "Queens", "Staten Island"];
var left = 0;
var right = 1000;


function getvis( y ){
    return left <= y  && y <= right;
}

function getDistanceFromLatLonInKm(lat1,lon1,lat2,lon2) {
  var R = 6371; // Radius of the earth in km
  var dLat = deg2rad(lat2-lat1);  // deg2rad below
  var dLon = deg2rad(lon2-lon1); 
  var a = 
    Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
    Math.sin(dLon/2) * Math.sin(dLon/2)
    ; 
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
  var d = R * c; // Distance in km
  return d;
}

function deg2rad(deg) {
  return deg * (Math.PI/180);
}

function getLatLng( p ){
    var tmp = p.replace('POINT','').replace('(','').replace(')','');
    var coor = tmp.split(" ");
    return  new google.maps.LatLng(parseFloat(coor[2]), parseFloat(coor[1]) );
}    

function getID( position ){

    var ans = -1;
    map.data.forEach( function ( feature ){
    
        if( ans != -1 ) return;
        var mypol;
        if (feature.getGeometry().getType() == "Polygon") {
            
            mypol = new google.maps.Polygon({
                paths: feature.b.b[0].b} );
            if(google.maps.geometry.poly.containsLocation(position, mypol) ){ ans = feature.getProperty("BoroCD");
            }
            
        }else{
            
            for( var i = 0; i<feature.b.b.length; i++ ){
                mypol = new google.maps.Polygon({
                paths: feature.b.b[i].b[0].b} );
                if(google.maps.geometry.poly.containsLocation(position, mypol) ){ ans = feature.getProperty("BoroCD");
                }   
            }
            
        }

    });
    return ans;
}

var distances = [];
var DistanceMarkers = [];
var centers = [];

var flag = false;

function loadData(){
    
    if( flag === true ) return;
    flag = false;
    map.data.forEach( function( feature ){
        
        var bounds = new google.maps.LatLngBounds();
        if (feature.getGeometry().getType() == "Polygon") {
            
            feature.getGeometry().forEachLatLng(function(path) {
              bounds.extend(path);
            });
        
            
        }else{
            
            for( var i = 0; i<feature.b.b.length; i++){
                feature.b.b[i].forEachLatLng( function( coor ){
                   bounds.extend(coor);
                });
            }
            
            
        }
        centers.push( bounds.getCenter());
        distances.push( getDistanceFromLatLonInKm(bounds.getCenter().lat(), bounds.getCenter().lng(),40.7291,-73.9965) );  
        
        var marker = new google.maps.Marker({
            map:map,
            position: centers[feature.j-1],
            label : String(distances[feature.j - 1])
        });
        marker.setVisible(false);
        DistanceMarkers.push(marker);
       
    });
    
}


function loadDistricts ( ) {
    
    loadData();
    map.data.setStyle(function(feature) {
        return ({
            fillColor: getColorByBoroCD(feature.getProperty("BoroCD")),
            strokeWeight: 1,
            visible : getvis(feature.getProperty("BoroCD"))
        });
    });

    map.data.addListener('mouseover', function(event) {
        map.data.revertStyle();
        map.data.overrideStyle(event.feature, {
            fillColor: getColorByBoroCD(event.feature.getProperty("BoroCD")),
            strokeWeight: 2.5
        });
    });
    
    map.data.addListener('mouseout', function(event) {
      map.data.revertStyle();
    });
    
    
    map.setCenter({lat: 40.696984, lng: -73.946410});
    map.setZoom(11);
}


function hideDistricts(){
    
    map.data.setStyle(function(feature) {
        return ({
            visible : false,
        });
    });
    
    for( var i = 0; i<DistanceMarkers.length; i++){
        DistanceMarkers[i].setVisible(false);
    }
    
}

var NeighData = $.get( "https://data.cityofnewyork.us/api/views/xyye-rtrs/rows.json?accessType=DOWNLOAD", function(){});
var NeighborhoodsMarker = [];


function loadNeighborhoods( ){
    NeighborhoodsMarker = [];
    for( var i = 0; i < NeighData.responseJSON.data.length  ; i++ ){
        var pos = getLatLng(NeighData.responseJSON.data[i][9]);
        var id = HashNeigh[i];
        if( left <= id && id <= right ){
            var marker = new google.maps.Marker({
                map:map,
                position: pos,
                icon: {
                    size: new google.maps.Size(20, 20),
                    scaledSize: new google.maps.Size(19, 19),
                    url: 'http://maps.google.com/mapfiles/ms/icons/blue-pushpin.png' 
                },
            });
            NeighborhoodsMarker.push( marker );
        }
    }
}


function hideNeighborhoods(){
    for( var i = 0; i<NeighborhoodsMarker.length; i++){
        NeighborhoodsMarker[i].setMap(null);
    }
}

var CrimeData = $.get("https://data.cityofnewyork.us/resource/9s4h-37hy.json?rpt_dt=2015-12-31T00:00:00.000", function(){});
var CrimesMarkers = [];

function loadCrimes( ){
    
    CrimesMarkers = [];
    
    var c = 0;
    for ( var i = 0; i<CrimeData.responseJSON.length; i++ ){
        if( typeof( CrimeData.responseJSON[i].lat_lon ) === "undefined" ) continue;
        
        var lat = CrimeData.responseJSON[i].latitude;
        var lon = CrimeData.responseJSON[i].longitude;
        var pos = new google.maps.LatLng(parseFloat(lat), parseFloat(lon) );
        
        var id = HashCrime[c];
        
        if( left <= id && id <= right ){
            var marker = new google.maps.Marker({
                map:map,
                position: pos,
                icon: {
                    size: new google.maps.Size(20, 20),
                    scaledSize: new google.maps.Size(19, 19),
                    url: 'http://maps.google.com/mapfiles/ms/icons/caution.png'
                },
            });
            CrimesMarkers.push( marker );
        }
        c++;   
    }
}


function hideCrimes(){
    for( var i = 0; i<CrimesMarkers.length; i++ ){
        CrimesMarkers[i].setMap(null);
    }
}


var housingData = $.get(" https://data.cityofnewyork.us/api/views/hg8x-zxpr/rows.json?accessType=DOWNLOAD", function(){});


var afford = [];

function loadHousing(){
    for( var x = 0; x < 1000; x++ ) afford.push( 0 );
    
    for( var i = 0; i<housingData.responseJSON.data.length; i++ ){
        var lat  = housingData.responseJSON.data[i][23];
        var lon = housingData.responseJSON.data[i][24];
        var cn = housingData.responseJSON.data[i][31];
        
        if(  lat != null  && lon != null  && cn != 0 ){
            
            var pos = new google.maps.LatLng(parseFloat(lat), parseFloat(lon) );
            
            var id = getID ( pos );
            if( id != -1 ) afford[id]++;

        }
    }
    
    /*map.data.forEach( function ( feature ){
       console.log ( feature.j , afford[ feature.getProperty("BoroCD")]);
    });*/
}


var ord = [];
var hord = [];
var sord = [];
var completeRank = [];
var tot = [];

function comp( x , y ){
    var all = x.length;
    for( var it = 1; it< all; it++ ){
        if( x[it] < y[it ]) return true;
    }
    return false;
}


function sort( arr ){
    
    var l = arr.length;
    for( var i = 0; i<l; i++){
        for( var j = i + 1; j<l; j++ ){
           if( comp( arr[j], arr[i]) === true ){
            var tmp = arr[i];
            arr[i] = arr[j];
            arr[j] = tmp;
           }
        }
    }
}


function updateTableRank(){
    tableReference = $("#distanceTable")[0];
    
    ord = [];
    
    map.data.forEach( function(feature){
        if( feature.getProperty("BoroCD") % 100 > 25 ) return;
        var x = [];
        x.push( feature );
        x.push( distances[feature.j - 1 ]);
        ord.push( x );
    });
    sort(ord);
    
    for( var i = 0; i<ord.length; i++ ){
        completeRank[ ord[i][0].j ] += i + 1;
        if( i >= 10 ) continue;
        newRow = tableReference.insertRow(tableReference.rows.length);
        boro = newRow.insertCell(0);
        num = newRow.insertCell(1);
        dis = newRow.insertCell(2);
        var cd = ord[i][0].getProperty("BoroCD");
        boro.innerHTML = BoroName[Math.floor( cd / 100 ) - 1 ];
        num.innerHTML = cd % 100;
        dis.innerHTML = ord[i][1];   
    }
}
 
function updateTableAfford(){
    tableReference = $("#affordTable")[0];
    
    hord = [];
    
    map.data.forEach( function (feature ){
        if( feature.getProperty("BoroCD") % 100 > 25 ) return;
        var x = [];
        x.push( feature );
        x.push( - HashAfford[feature.j - 1] );
        hord.push( x );
    });
    sort( hord )
    
    for( var i = 0; i<hord.length; i++){
        completeRank[ hord[i][0].j ] += i + 1;
        if( i >= 10 ) continue;
        newRow = tableReference.insertRow(tableReference.rows.length);
        boro = newRow.insertCell(0);
        num = newRow.insertCell(1);
        cn = newRow.insertCell(2);
        var cd = hord[i][0].getProperty("BoroCD");
        boro.innerHTML = BoroName[Math.floor( cd / 100 ) - 1 ];
        num.innerHTML = cd % 100;
        cn.innerHTML = - hord[i][1];
    }
} 

function updateTableSec(){
    tableReference = $("#secTable")[0];
    
    sord = [];
    
    map.data.forEach( function (feature ){
        if( feature.getProperty("BoroCD") % 100 > 25 ) return;
        
        var cnt = 0;
        for( var j = 0; j < HashCrime.length; j++ ){
            if(HashCrime[j] == feature.getProperty("BoroCD")) cnt++;
        }
        var x = [];
        x.push( feature );
        x.push( cnt );
        sord.push( x );
    });
    sort( sord )
    
    for( var i = 0; i<sord.length; i++){
        completeRank[ sord[i][0].j ] += i + 1;
        if( i >= 10 ) continue;
        newRow = tableReference.insertRow(tableReference.rows.length);
        boro = newRow.insertCell(0);
        num = newRow.insertCell(1);
        cn = newRow.insertCell(2);
        var cd = sord[i][0].getProperty("BoroCD");
        boro.innerHTML = BoroName[Math.floor( cd / 100 ) - 1 ];
        num.innerHTML = cd % 100;
        cn.innerHTML = sord[i][1];
    }
}
 
 
function updateGeneralTable(){
    
    tableReference = $("#GenTable")[0];
    
    map.data.forEach( function( feature){
        if( feature.getProperty("BoroCD") % 100 > 25 ) return;
        
        var x = [];
        x.push( feature );
        x.push( completeRank[feature.j] );
        tot.push( x );    
    });
    
    sort( tot );
    
    for( var i = 0; i < 10; i++ ){
        newRow = tableReference.insertRow(tableReference.rows.length);
        boro = newRow.insertCell(0);
        num = newRow.insertCell(1);
        var cd = tot[i][0].getProperty("BoroCD");
        boro.innerHTML = BoroName[ Math.floor( cd / 100 ) - 1 ];
        num.innerHTML = cd % 100;
    }
}
 
function loadOnMap( x ){
    left = x[0].getProperty("BoroCD");
    right = x[0].getProperty("BoroCD");
    
    var pos = x[0].j - 1;
    DistanceMarkers[ pos ].setVisible( true );
    map.data.setStyle(function(feature) {
        return ({
            fillColor: "black",
            strokeWeight: 1,
            visible : (feature.j == pos + 1)
        });
    });
    map.setCenter(DistanceMarkers[pos].position);
    map.setZoom(13);
} 

function clearMap(){
    hideDistricts();
    hideNeighborhoods();
    hideCrimes();
    
    $("#getDistricts")[0].innerHTML = "Hide Districts";
    $("#getCrimes")[0].innerHTML = "Get Crimes";
    $("#getNeighborhoods")[0].innerHTML = "Show Neighborhoods";

}


function initBoro( x ){
    left = 100 * x;
    right = left + 99;
    loadDistricts();
}

var flag2 = false;



$(document).ready( function (){
    
    function exportTableToCSV($table, filename) {
        var $headers = $table.find('tr:has(th)')
            ,$rows = $table.find('tr:has(td)')
            ,tmpColDelim = String.fromCharCode(11) 
            ,tmpRowDelim = String.fromCharCode(0) 
            ,colDelim = '","'
            ,rowDelim = '"\r\n"';
            var csv = '"';
            csv += formatRows($headers.map(grabRow));
            csv += rowDelim;
            csv += formatRows($rows.map(grabRow)) + '"';

            var csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(csv);

        if (window.navigator.msSaveOrOpenBlob) {
            var blob = new Blob([decodeURIComponent(encodeURI(csv))], {
                type: "text/csv;charset=utf-8;"
            });
            navigator.msSaveBlob(blob, filename);
        } else {
            $(this)
                .attr({
                    'download': filename
                    ,'href': csvData
            });
        }

        function formatRows(rows){
            return rows.get().join(tmpRowDelim)
                .split(tmpRowDelim).join(rowDelim)
                .split(tmpColDelim).join(colDelim);
        }

        function grabRow(i,row){
             
            var $row = $(row);

            var $cols = $row.find('td'); 
            if(!$cols.length) $cols = $row.find('th');  

            return $cols.map(grabCol)
                        .get().join(tmpColDelim);
        }

        function grabCol(j,col){
            var $col = $(col),
                $text = $col.text();

            return $text.replace('"', '""');

        }
    }


    $("#exportDis").click(function (event) {
        
        var outputFile =  'distanceRanking';
        outputFile = outputFile.replace('.csv','') + '.csv'
         
        exportTableToCSV.apply(this, [$('#dvData > table'), outputFile]);
    });
    
    
    $("#exportAfford").click(function (event) {
        
        var outputFile =  'affordRanking';
        outputFile = outputFile.replace('.csv','') + '.csv'
         
        exportTableToCSV.apply(this, [$('#dvData2 > table'), outputFile]);
    });
    
    
    $("#exportSec").click(function (event) {
        
        var outputFile =  'securityRanking';
        outputFile = outputFile.replace('.csv','') + '.csv'
         
        exportTableToCSV.apply(this, [$('#dvData3 > table'), outputFile]);
    });
    
    $("#exportAll").click(function (event) {
        
        var outputFile =  'GeneralRanking';
        outputFile = outputFile.replace('.csv','') + '.csv'
         
        exportTableToCSV.apply(this, [$('#dvData4 > table'), outputFile]);
    });
    
    $("#rankMode").on("click", function(){
        //loadHousing(); too slow -> precomputing without separing by district to earn both memory and time
        if( flag2 === true ) return;
        flag2 = true;
        for( var i = 0; i<100; i++ ) completeRank.push( 0 );
        loadData();
        updateTableRank();
        updateTableAfford();
        updateTableSec();
        updateGeneralTable();
    });
    
    $("#distanceTable").on('click', 'tr', function() {
        clearMap();
        var pos;
        if(isNaN (this.previousSibling.rowIndex - 1) ) pos = 0;
        else pos = this.previousSibling.rowIndex - 1;
        loadOnMap( ord[pos] );
    });
    
    
    $("#GenTable").on('click', 'tr', function() {
        clearMap();
        var pos;
        if(isNaN (this.previousSibling.rowIndex - 1) ) pos = 0;
        else pos = this.previousSibling.rowIndex - 1;
        loadOnMap( tot[pos] );
    });
    
    $("#affordTable").on('click', 'tr', function() {
        clearMap();
        var pos;
        if(isNaN (this.previousSibling.rowIndex - 1) ) pos = 0;
        else pos = this.previousSibling.rowIndex - 1;
        loadOnMap( hord[pos] );
    });
    
    $("#secTable").on('click', 'tr', function() {
        clearMap();
        var pos;
        if(isNaN (this.previousSibling.rowIndex - 1) ) pos = 0;
        else pos = this.previousSibling.rowIndex - 1;
        loadOnMap( sord[pos] );
    });
    
    
    $("#getDistricts").on("click", function(){
        
        if( this.innerHTML == "District Separation"){
            this.innerHTML = "Hide Districts";
            loadDistricts();
         }else if (this. innerHTML == "Hide Districts"){
             hideDistricts();
             this.innerHTML = "District Separation";
             left = 0;
             right = 1000;
         }
    });      
 
    $("#getNeighborhoods").on("click", function(){
        if( this.innerHTML == "Show Neighborhoods"){
            loadNeighborhoods();
            this.innerHTML = "Hide Neighborhoods";
        }else if (this. innerHTML == "Hide Neighborhoods"){
            hideNeighborhoods();
            this.innerHTML = "Show Neighborhoods";
        }
    });
    
    $("#getCrimes").on("click", function(){
        if( this.innerHTML == "Get Crimes"){
            loadCrimes();
            this.innerHTML = "Hide Crimes";
        }else if (this. innerHTML == "Hide Crimes"){
            hideCrimes();
            this.innerHTML = "Get Crimes";
        }
    });

 
    $("#getManhattan").on("click", function(){
        clearMap();
        initBoro( 1 );
        map.setCenter( {lat: 40.773860, lng: -73.962955});
    });

    
    $("#getBronx").on("click", function(){
        clearMap();
        initBoro( 2 );
        map.setCenter( {lat: 40.853959, lng: -73.854776});
    });
    
    $("#getBrooklyn").on("click", function(){
        clearMap();
        initBoro( 3 );
        map.setCenter( {lat: 40.646397, lng: -73.928401});
    });
    
    $("#getQueens").on("click", function(){
        clearMap();
        initBoro( 4 );
        map.setCenter( {lat: 40.678304, lng: -73.779590});
    });
    
    $("#getIsland").on("click", function(){
        clearMap();
        initBoro( 5 );
        map.setCenter( {lat: 40.578100, lng: -74.150357});
    });
    
});


var dropdown = document.getElementsByClassName("dropdown-btn");
for (var i = 0; i < dropdown.length; i++) {
    dropdown[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var dropdownContent = this.nextElementSibling;
    if (dropdownContent.style.display === "block") {
      dropdownContent.style.display = "none";
    } else {
      dropdownContent.style.display = "block";
    }
  });
}


